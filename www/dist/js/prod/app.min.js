var app = angular.module('assignment', [
    'ngRoute',
    'nvd3',
    'chart.js'
]);

app.run(function () {
    "ngInject";
});






function template(name) {
    return 'templates/' + name;
}

app.config(function ($routeProvider, $locationProvider) {
    "ngInject";
    $routeProvider.when('/dashboard', 
        {
            templateUrl: template('home.html'), 
            reloadOnSearch: false
        })
        .otherwise({ redirectTo: '/dashboard' });

    $locationProvider.html5Mode(true);  

}).run(function run($rootScope, $location, $window) {
    "ngInject";

    $rootScope.$on('$locationChangeStart', function (event, next, current) {

    });
});
app.controller('BarChartController', function ($scope) {
    "ngInject";

  $scope.labels = ['2006', '2007', '2008'];
  $scope.series = ['Series A', 'Series B'];

  $scope.data = [
    [65, 59, 80],
    [28, 48, 40]
  ];

  $scope.colors = ['#2196F3','#FF9800'];
  
  $scope.datasetOverride = [
            {
                fill: true,
                backgroundColor: "#2196F3"
            },
            {
                fill: true,
                backgroundColor: "#FF9800"
            }];

});
app.controller('LineChartController', function ($scope) {
    "ngInject";

  $scope.labels = ["January", "February", "March", "April", "May", "June", "July"];
  $scope.series = ['Series A'];
  $scope.data = [
    [65, 59, 80, 81, 56, 55, 40]
  ];

  $scope.onClick = function (points, evt) {
    
  };

  $scope.datasetOverride = [{ yAxisID: 'y-axis-1' }, { yAxisID: 'y-axis-2' }];
  $scope.options = {
    scales: {
      yAxes: [
        {
          id: 'y-axis-1',
          type: 'linear',
          display: true,
          position: 'left'
        },
        {
          id: 'y-axis-2',
          type: 'linear',
          display: false,
          position: 'right'
        }
      ]
    }
  };
});

app.controller('MainController', function ($scope) {
 "ngInject";
  
  var widgetTemp = false;

  /**Widget dialog controll */
  $scope.widget = function(){
      
      widgetTemp = !widgetTemp;
      
      if ( widgetTemp ){
        angular.element('html, body').animate({ scrollTop: 0 }, 'fast');
        angular.element('#widget-container').css("width", "40%");
        angular.element('body').css("overflow", "hidden"); 
      } else {
        angular.element('#widget-container').css("width", "0%");
        angular.element('body').css("overflow", "auto");        
      }
     
  };

  //window height

  function getHeight(){
    var height = angular.element( window ).height();
    height = height/2-40;
    angular.element('#widget-top').css("top", height+'px');
    angular.element('#widget-button').css("top",height+65+'px');
    angular.element('#widget-bottom').css("top", height+65+64+'px');  

    console.log('fine');
  }

  angular.element(document).ready(function() {
     getHeight();   
  });
  
  angular.element(window).resize(function() {
    getHeight();  
  });

  $scope.options = {
    chart: {
        type: 'discreteBarChart',
        height: 450,
        x: function(d){ return d.label; },
        y: function(d){ return d.value; },
        showValues: true,
        valueFormat: function(d){
            return d3.format(',.4f')(d);
        },
        transitionDuration: 500,
        xAxis: {
            axisLabel: 'X Axis'
        },
        yAxis: {
            axisLabel: 'Y Axis',
            axisLabelDistance: 30
        }
    }
 };

  $scope.data = [{
        key: "Cumulative Return",
        values: [
            { "label" : "A" , "value" : -29.765957771107 },
            { "label" : "B" , "value" : 0 },
            { "label" : "C" , "value" : 32.807804682612 },
            { "label" : "D" , "value" : 196.45946739256 },
            { "label" : "E" , "value" : 0.19434030906893 },
            { "label" : "F" , "value" : -98.079782601442 },
            { "label" : "G" , "value" : -13.925743130903 },
            { "label" : "H" , "value" : -5.1387322875705 }
        ]
    }];

});
app.controller('PieChartController', function ($scope) {
    "ngInject";

    $scope.pie_chart_options = {
        chart: {
            type: 'pieChart',
            height: 220,
            showLabels: false,
            duration: 500,
            labelThreshold: 0.01,
            labelSunbeamLayout: false
        }
    };

    $scope.pie_chart_data = [
        {
            key: "One",
            y: 5
        },
        {
            key: "Two",
            y: 2
        },
        {
            key: "Three",
            y: 9
        }
    ];
});

app.factory('assignSettings', function () {
    "ngInject";

    return {
       
    };
});